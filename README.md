# ESTç”Ÿå­˜åˆ†ææ¨¡å‹Webéƒ¨ç½²ç³»ç»Ÿ

åŸºäºExtra Survival Trees (EST)æ¨¡å‹çš„ç”Ÿå­˜åˆ†æWebåº”ç”¨ï¼Œæä¾›ç”¨æˆ·å‹å¥½çš„ç•Œé¢è¿›è¡Œç”Ÿå­˜é£é™©é¢„æµ‹ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ”¬ **ESTæ¨¡å‹é¢„æµ‹**: åŸºäºExtra Survival Treesç®—æ³•çš„ç”Ÿå­˜åˆ†æ
- ğŸŒ **Webç•Œé¢**: ç›´è§‚çš„æ•°æ®è¾“å…¥å’Œç»“æœå±•ç¤ºç•Œé¢
- ğŸ“Š **å¯è§†åŒ–ç»“æœ**: ç”Ÿå­˜æ›²çº¿å’Œç‰¹å¾é‡è¦æ€§å›¾è¡¨
- ğŸ”’ **æ•°æ®éªŒè¯**: å®Œæ•´çš„è¾“å…¥æ•°æ®éªŒè¯å’Œé”™è¯¯å¤„ç†
- ğŸ“± **å“åº”å¼è®¾è®¡**: æ”¯æŒæ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡è®¿é—®
- âš¡ **å®æ—¶é¢„æµ‹**: å¿«é€Ÿçš„æ¨¡å‹æ¨ç†å’Œç»“æœè¿”å›

## ç³»ç»Ÿæ¶æ„

```
est-survival-web/
â”œâ”€â”€ app.py                 # Flaskä¸»åº”ç”¨æ–‡ä»¶
â”œâ”€â”€ model_utils.py         # æ¨¡å‹ç®¡ç†å·¥å…·
â”œâ”€â”€ requirements.txt       # Pythonä¾èµ–
â”œâ”€â”€ README.md             # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ templates/            # HTMLæ¨¡æ¿
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ static/               # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ style.css
â”‚   â””â”€â”€ js/
â”‚       â””â”€â”€ main.js
â””â”€â”€ models/               # æ¨¡å‹æ–‡ä»¶ç›®å½•
    â””â”€â”€ est_model.pkl     # è®­ç»ƒå¥½çš„ESTæ¨¡å‹
```

## ç¯å¢ƒè¦æ±‚

- Python 3.8+
- å†…å­˜: è‡³å°‘2GB
- ç£ç›˜ç©ºé—´: è‡³å°‘1GB

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone <repository-url>
cd est-survival-web
```

### 2. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ

```bash
# Windows
python -m venv venv
venv\Scripts\activate

# Linux/Mac
python3 -m venv venv
source venv/bin/activate
```

### 3. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 4. å‡†å¤‡æ¨¡å‹æ–‡ä»¶

å°†è®­ç»ƒå¥½çš„ESTæ¨¡å‹æ–‡ä»¶æ”¾ç½®åœ¨ä»¥ä¸‹ä½ç½®ä¹‹ä¸€ï¼š
- `./models/est_model.pkl`
- `./est_model.pkl`
- `../est_model.pkl`

å¦‚æœæ²¡æœ‰é¢„è®­ç»ƒæ¨¡å‹ï¼Œç³»ç»Ÿå°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ªé»˜è®¤æ¨¡å‹ç”¨äºæ¼”ç¤ºã€‚

### 5. å¯åŠ¨åº”ç”¨

#### å¼€å‘æ¨¡å¼

```bash
python app.py
```

åº”ç”¨å°†åœ¨ http://localhost:5000 å¯åŠ¨

#### ç”Ÿäº§æ¨¡å¼

```bash
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

## ä½¿ç”¨è¯´æ˜

### æ•°æ®è¾“å…¥

ç³»ç»Ÿæ”¯æŒä»¥ä¸‹ç‰¹å¾è¾“å…¥ï¼š

#### ç”ŸåŒ–æŒ‡æ ‡
- **ç™½è›‹ç™½ (Albumin)**: 35-50 g/L
- **è¡€çº¢è›‹ç™½ (Hemoglobin)**: 120-160 g/L
- **è‚Œé… (Creatinine)**: 44-133 Î¼mol/L
- **å°¿ç´  (Urea)**: 2.9-8.2 mmol/L
- **é’  (Sodium)**: 136-145 mmol/L
- **é’¾ (Potassium)**: 3.5-5.1 mmol/L

#### ç–¾ç—…å² (0=æ— , 1=æœ‰)
- å† å¿ƒç—…å²
- ç³–å°¿ç—…å²
- é«˜è¡€å‹å²
- è„‘å’ä¸­å²
- æ¶æ€§è‚¿ç˜¤å²
- æ…¢æ€§é˜»å¡æ€§è‚ºç—…
- æ…¢æ€§è‚¾ç—…
- è‚ç—…å²
- ç—´å‘†å²
- æŠ‘éƒç—‡å²

### é¢„æµ‹ç»“æœ

ç³»ç»Ÿæä¾›ä»¥ä¸‹é¢„æµ‹ç»“æœï¼š

1. **é£é™©è¯„åˆ†**: 0-1ä¹‹é—´çš„æ•°å€¼ï¼Œè¶Šé«˜è¡¨ç¤ºé£é™©è¶Šå¤§
2. **é£é™©ç­‰çº§**: ä½é£é™©/ä¸­ç­‰é£é™©/é«˜é£é™©
3. **ç”Ÿå­˜æ¦‚ç‡**: åœ¨ç‰¹å®šæ—¶é—´ç‚¹çš„ç”Ÿå­˜æ¦‚ç‡
4. **ç”Ÿå­˜æ›²çº¿**: ä¸ªä½“åŒ–çš„ç”Ÿå­˜å‡½æ•°å›¾è¡¨
5. **ç‰¹å¾é‡è¦æ€§**: å„ç‰¹å¾å¯¹é¢„æµ‹ç»“æœçš„è´¡çŒ®åº¦

## APIæ¥å£

### é¢„æµ‹æ¥å£

**POST** `/api/predict`

è¯·æ±‚ä½“:
```json
{
    "Albumin": 35.2,
    "Hemoglobin": 120.5,
    "Creatinine": 88.3,
    "Urea": 6.8,
    "Sodium": 140.2,
    "Potassium": 4.1,
    "Coronary_Heart_Disease": 1,
    "Diabetes": 0,
    "Hypertension": 1,
    "Stroke": 0,
    "Malignancy": 0,
    "COPD": 0,
    "CKD": 1,
    "Liver_Disease": 0,
    "Dementia": 0,
    "Depression": 0
}
```

å“åº”:
```json
{
    "risk_score": 0.456,
    "survival_probability": 0.723,
    "predicted_time": 365,
    "survival_function": {
        "times": [30, 60, 90, 180, 365],
        "probabilities": [0.95, 0.89, 0.82, 0.75, 0.68]
    },
    "feature_importance": {
        "Albumin": 0.15,
        "Creatinine": 0.12,
        "CKD": 0.10
    }
}
```

### æ¨¡å‹ä¿¡æ¯æ¥å£

**GET** `/api/model_info`

å“åº”:
```json
{
    "model_type": "ExtraSurvivalTrees",
    "features": ["Albumin", "Hemoglobin", ...],
    "feature_count": 16,
    "model_loaded": true
}
```

### å¥åº·æ£€æŸ¥æ¥å£

**GET** `/health`

å“åº”:
```json
{
    "status": "healthy",
    "model_loaded": true,
    "timestamp": "2024-01-15T10:30:00Z"
}
```

## éƒ¨ç½²é…ç½®

### Dockeréƒ¨ç½²

åˆ›å»º `Dockerfile`:

```dockerfile
FROM python:3.9-slim

WORKDIR /app

COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

COPY . .

EXPOSE 5000

CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:5000", "app:app"]
```

æ„å»ºå’Œè¿è¡Œ:

```bash
docker build -t est-survival-web .
docker run -p 5000:5000 est-survival-web
```

### Nginxé…ç½®

```nginx
server {
    listen 80;
    server_name your-domain.com;
    
    location / {
        proxy_pass http://127.0.0.1:5000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    location /static {
        alias /path/to/your/app/static;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ¨¡å‹åŠ è½½å¤±è´¥**
   - æ£€æŸ¥æ¨¡å‹æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤æ¨¡å‹æ–‡ä»¶æ ¼å¼å…¼å®¹
   - æŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

2. **é¢„æµ‹ç»“æœå¼‚å¸¸**
   - éªŒè¯è¾“å…¥æ•°æ®æ ¼å¼å’ŒèŒƒå›´
   - æ£€æŸ¥ç‰¹å¾åç§°æ˜¯å¦åŒ¹é…
   - ç¡®è®¤æ¨¡å‹è®­ç»ƒæ—¶çš„ç‰¹å¾é¡ºåº

3. **æ€§èƒ½é—®é¢˜**
   - å¢åŠ Gunicorn workeræ•°é‡
   - ä½¿ç”¨Redisç¼“å­˜é¢„æµ‹ç»“æœ
   - ä¼˜åŒ–æ¨¡å‹åŠ è½½ç­–ç•¥

### æ—¥å¿—é…ç½®

åº”ç”¨æ—¥å¿—ä¿å­˜åœ¨ `app.log` æ–‡ä»¶ä¸­ï¼ŒåŒ…å«ï¼š
- è¯·æ±‚å¤„ç†æ—¥å¿—
- æ¨¡å‹é¢„æµ‹æ—¥å¿—
- é”™è¯¯å’Œå¼‚å¸¸ä¿¡æ¯

## å®‰å…¨æ³¨æ„äº‹é¡¹

- ğŸ”’ ä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨DEBUGæ¨¡å¼
- ğŸ›¡ï¸ é…ç½®é€‚å½“çš„CORSç­–ç•¥
- ğŸ” å¯¹æ•æ„ŸåŒ»ç–—æ•°æ®è¿›è¡ŒåŠ å¯†ä¼ è¾“
- ğŸ“ å®šæœŸå¤‡ä»½æ¨¡å‹å’Œé…ç½®æ–‡ä»¶
- ğŸš« é™åˆ¶APIè®¿é—®é¢‘ç‡é˜²æ­¢æ»¥ç”¨

## è®¸å¯è¯

æœ¬é¡¹ç›®ä»…ä¾›åŒ»å­¦ç ”ç©¶å’Œæ•™è‚²ç”¨é€”ï¼Œä¸å¾—ç”¨äºä¸´åºŠè¯Šæ–­å†³ç­–ã€‚

## è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

---

**å…è´£å£°æ˜**: æœ¬ç³»ç»Ÿæä¾›çš„é¢„æµ‹ç»“æœä»…ä¾›å‚è€ƒï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šåŒ»ç–—è¯Šæ–­å’Œæ²»ç–—å»ºè®®ã€‚